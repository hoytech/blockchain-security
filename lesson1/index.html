<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">

    <title>Blockchain Security</title>

    <meta name="author" content="Doug Hoyte">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

    <link rel="stylesheet" href="../reveal.js/css/reveal.css">
    <link rel="stylesheet" href="../reveal.js/css/theme/black.css" id="theme">

    <!-- Code syntax highlighting -->
    <link rel="stylesheet" href="../reveal.js/lib/css/zenburn.css">

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? '../reveal.js/css/print/pdf.css' : '../reveal.js/css/print/paper.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>

    <!--[if lt IE 9]>
    <script src="../reveal.js/lib/js/html5shiv.js"></script>
    <![endif]-->

    <style>
      .reveal .slides h1, .reveal .slides h2, .reveal .slides h3 {
        text-transform: none;
      }

      .two-column {
        display: flex;
        flex-wrap: wrap;
      }

      .two-column em {
        margin: 20px;
      }
    </style>
  </head>

  <body>
    <div class="reveal">
      <div class="slides">

<!------------------------------------------------------->



<section data-markdown><script type="text/template">

# Blockchain Security

### Lesson 1: Cryptographic Primitives

</script></section>




<section data-markdown><script type="text/template">

## Topics

* Randomness
* Hash functions
* Digital signatures

</script></section>




<section data-markdown><script type="text/template">

## Randomness

* Without randomness, all operations would be predictable, and therefore insecure
* Cryptography, and therefore blockchains, could not exist
* Needed for generating secret keys, encryption protocols, and much more

</script></section>




<section data-markdown><script type="text/template">

## Computing random numbers

"Any one who considers arithmetical methods of producing random digits is, of course, in a state of sin. For, as has been pointed out several times, there is no such thing as a random number — there are only methods to produce random numbers, and a strict arithmetic procedure of course is not such a method."

—John von Neumann

</script></section>




<section data-markdown><script type="text/template">

## True random processes

* Thermal noise
* Radioactive decay
* Network packet arrival times
* Wiggling mouse/pounding on keyboard (?)
 
</script></section>




<section data-markdown><script type="text/template">

## Pseudo-randomness

* PRNG (Pseudo-Random Number Generator)
  * Deterministic process that generates numbers
* CSPRNG (Cryptographically Secure PRNG)
  * Must be unpredictable and unbiased
  * "Stretches" the randomness from a "seed" (small value from a true RNG)

</script></section>



<section data-markdown><script type="text/template">

## Mistake 1: Using bad RNGs

Linear Congruential Generator (LCG)

<img src="chainsaw.gif" />

</script></section>



<section data-markdown><script type="text/template">

## Mistake 2: Too small seeds

* If your seed is only 32 bits bytes you will only have <pre>2<sup>32</sup> = ~4 billion</pre> different possible CSPRNG streams
* Breakable in a few seconds
* Use at least 128 bits of randomness for your seeds

</script></section>



<section data-markdown><script type="text/template">

## Mistake 3: Mod bias

    function rollD6() {
        return 1 + (getRandom() % 6);
    }

* Depending on the output range of `getRandom()`, `rollD6()` will be biased
* Why?

</script></section>




<section data-markdown><script type="text/template">

## Demos

* [dice.html](dice.html)
* [randviz.html](randviz.html)

</script></section>



<section data-markdown><script type="text/template">

## Moral of the story

* For crypto, always use a secure random number generator provided by your environment or OS
  * Web-browser: `window.crypto.getRandomValues()`
  * Linux/OS X: `/dev/urandom`
  * Windows: `RtlGenRandom`

</script></section>


<section data-markdown><script type="text/template">

## Questions, 15 min break

</script></section>






<section data-markdown><script type="text/template">

## Principle: Computational Infeasability

* Important cryptographic assumption
* If attackers try every possible random value, they can crack our crypto-system
* So, we make sure there are so many possible random values that it would take "forever" for them to do so

</script></section>




<section data-markdown><script type="text/template">

## Hash functions

* The core building block of blockchain technology
* Functions that take an unlimited-size input and return a fixed size output:

$h = H(m)$

</script></section>




<section data-markdown><script type="text/template">

## Preimage-resistance

* Hashing is a "one-way" function
* If you only know the hash of a secret, it's hard to find that secret
* Formally: given an arbitrary $h$, it is computationally infeasible to find an $m$ such that $H(m) = h$

</script></section>


<!--
<section data-markdown><script type="text/template">

## Second preimage-resistance
 
* Hard to find another message that hashes the same as your message
* Given $m$, it should be hard to find a distinct $m'$ such that $H(m) = H(m')$

</script></section>
-->



<section data-markdown><script type="text/template">

## Mistake 1: Small preimage domain

* Be careful when anonymizing names/IPs/emails by hashing
* If there aren't that many possible secrets, you can just try all of them
* Exercise: [preimage.html](preimage.html)
* So much for "one-way" function
 
</script></section>



<section data-markdown><script type="text/template">

## Collision-resistance

* Hard to find any two messages that hash to the same value
* Formally: Computationally infeasible to find distinct $m$ and $m'$ such that $H(m) = H(m')$
* All hash functions have collisions because...

</script></section>



<section data-markdown><script type="text/template">

## Pigeon-hole principle

<img src="pigeonhole.svg" />

</script></section>



<section data-markdown><script type="text/template">

## Collision attacks

* Hash functions are almost always attacked by finding collisions, not specific preimages
* MD5 and SHA1 are insecure because it is easier than it should be to find collisions
  * Both are still practically secure against preimage attacks though
* Why is it easier to find collisions?

</script></section>



<section data-markdown><script type="text/template">

## Birthday experiment

* Doesn't always work, but it's fun when it does

</script></section>




<section data-markdown><script type="text/template">

## Rho method (tortoise and hare)

* Memory-efficient way to search for collisions
* Named because it looks like greek letter <b><i>ρ</i></b>

<img src="rho.svg" style="background-color: white;" />

</script></section>



<section data-markdown><script type="text/template">

## Mistake 2: Equivalent inputs

    function hashUserInfo(username, userId) {
        return sha1(username + userId);
    }

`hashUserInfo("john", 234)`

`hashUserInfo("john2", 34)`

</script></section>



<section data-markdown><script type="text/template">

## Mistake 3: Length extension

* With older hash functions, given a hash you can add data to the end of an unknown preimage and compute a valid hash for it:
  * MD5, SHA1, SHA256
* Doesn't have this problem:
  * SHA3, BLAKE2, SHA512/256, double SHA256 (see bitcoin)

</script></section>



<section data-markdown><script type="text/template">

## Questions, 15 min break

</script></section>




<!------------------------------------------------------->


      </div>

    </div>

    <script src="../reveal.js/lib/js/head.min.js"></script>
    <script src="../reveal.js/js/reveal.js"></script>

    <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,

        transition: 'none', // none/fade/slide/convex/concave/zoom

	math: {
          mathjax: '../lib/MathJax/MathJax.js',
          config: 'TeX-AMS_SVG-full',
	},

        // Optional reveal.js plugins
        dependencies: [
          { src: '../reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: '../reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
          { src: '../reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
          { src: '../reveal.js/plugin/math/math.js', async: true },
        ]
      });

    </script>

  </body>
</html>
